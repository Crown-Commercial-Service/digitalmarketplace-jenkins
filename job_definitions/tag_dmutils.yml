{% set packages = ['utils', 'apiclient', 'content-loader', 'test-utils'] %}
---
{% for package in packages %}
- job:
    name: 'tag-dm{{ package }}'
    display-name: "Tag dm{{ package }}"
    project-type: freestyle
    description: "Push the git tag on the https://github.com/alphagov/digitalmarketplace-{{ package }} repository."
    logrotate:
      daysToKeep: 20
      artifactDaysToKeep: 20
    scm:
      - git:
          url: git@github.com:alphagov/digitalmarketplace-{{ package }}.git
          credentials-id: github_com_and_enterprise
          branches:
            - master
          skip-tag: true
    triggers:
      - pollscm: "H/2 * * * *"
    wrappers:
      - ansicolor
    builders:
      - shell: |
          git config user.name "Jenkins"
          ./scripts/push-tag.sh
{% endfor %}
